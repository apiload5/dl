# Add this to fix document root
files:
  # ... existing files ...
  
  # Fix Document Root
  "/opt/elasticbeanstalk/hooks/appdeploy/post/03_fix_document_root.sh":
    mode: "000755"
    owner: root
    group: root
    content: |
      #!/bin/bash
      # Fix Document Root for PHP Application
      
      echo "Fixing document root..."
      
      # Ensure all files are in correct location
      cd /var/www/html
      
      # Set proper permissions
      chown -R webapp:webapp /var/www/html
      chmod -R 755 /var/www/html
      
      # Make sure index.php exists
      if [ ! -f "/var/www/html/index.php" ]; then
          echo "ERROR: index.php not found in document root"
          ls -la /var/www/html/
      else
          echo "SUCCESS: index.php found in document root"
      fi
      
      # Test PHP syntax
      php -l /var/www/html/index.php || echo "PHP syntax error in index.php"
      
      echo "Document root fix complete"

container_commands:
  # ... existing commands ...
  
  06_fix_permissions:
    command: |
      # Fix all permissions
      cd /var/www/html
      chown -R webapp:webapp .
      chmod -R 755 .
      chmod 644 index.php
      chmod 644 .htaccess
    ignoreErrors: true
