# Install required packages
packages:
  yum:
    git: []
    wget: []
    python3: []
    python3-pip: []

commands:
  01_install_yt_dlp:
    command: |
      # Install yt-dlp
      python3 -m pip install --upgrade yt-dlp
      ln -sf /usr/local/bin/yt-dlp /usr/bin/yt-dlp
    ignoreErrors: true
    
  02_install_ffmpeg:
    command: |
      # Install FFmpeg
      amazon-linux-extras install epel -y
      yum install -y https://download1.rpmfusion.org/free/el/rpmfusion-free-release-7.noarch.rpm
      yum install -y ffmpeg ffmpeg-devel
    ignoreErrors: true
    
  03_setup_permissions:
    command: |
      # Set up permissions
      mkdir -p /tmp/downloads
      chmod 777 /tmp/downloads
      chown webapp:webapp /tmp/downloads
    ignoreErrors: true
