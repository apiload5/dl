# Environment Variables and Settings
option_settings:
  # Application environment variables
  aws:elasticbeanstalk:application:environment:
    APP_ENV: production
    APP_DEBUG: false
    PHP_MEMORY_LIMIT: 512M
    UPLOAD_MAX_SIZE: 100M
    
  # Health reporting
  aws:elasticbeanstalk:healthreporting:system:
    SystemType: enhanced
    HealthCheckSuccessThreshold: Ok
    
  # Monitoring
  aws:elasticbeanstalk:cloudwatch:logs:
    StreamLogs: true
    DeleteOnTerminate: false
    RetentionInDays: 7
    
  # Rolling deployments
  aws:elasticbeanstalk:command:
    DeploymentPolicy: Rolling
    BatchSizeType: Fixed
    BatchSize: 1
    
commands:
  01_create_log_files:
    command: |
      # Create log files with proper permissions
      touch /var/log/php_errors.log
      chmod 666 /var/log/php_errors.log
      chown webapp:webapp /var/log/php_errors.log || true
    ignoreErrors: true
